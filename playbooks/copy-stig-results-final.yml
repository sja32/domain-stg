---
- name: Copy STIG Results to Central Share
  hosts: all
  gather_facts: no
  vars:
    local_results_path: "C:\\Users\\Public\\Documents\\STIG-Compliance\\{{ inventory_hostname }}"

    group_folder_map:
      domain_controllers: "Domain-Controllers"
      member_servers: "Member-Servers"
      workstations: "Workstations"

    results_group_folder: "{{ group_folder_map[stig_server_group] }}"
    results_share_dest: "\\\\192.168.10.198\\STIG-Results\\{{ results_group_folder }}\\{{ inventory_hostname }}"

  tasks:
    - name: Ensure destination folder exists
      ansible.windows.win_file:
        path: "{{ results_share_dest }}"
        state: directory

    - name: Copy STIG result files to central share (replace existing)
      ansible.windows.win_copy:
        src: "{{ local_results_path }}\\"
        dest: "{{ results_share_dest }}\\"
        remote_src: yes
